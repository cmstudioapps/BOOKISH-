<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOOKISH - Descubra novos livros</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primaria: #8a2be2;
            --primaria-escura: #6a1b9a;
            --fundo: #121212;
            --superficie: #1e1e1e;
            --texto: #ffffff;
            --texto-secundario: #a0a0a0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            background-color: var(--fundo);
            color: var(--texto);
        }

        .cabecalho {
            background-color: var(--superficie);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primaria);
            text-decoration: none;
        }

        .logo i {
            margin-right: 10px;
        }

        .menu-superior {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .busca {
            display: flex;
            align-items: center;
        }

        .busca input {
            padding: 8px 15px;
            border-radius: 20px;
            border: none;
            background-color: var(--fundo);
            color: var(--texto);
            width: 200px;
        }

      .botao-escrever {
  position: fixed;
  bottom: 20px; /* Distância do rodapé */
  right: 20px;  /* Distância da lateral direita */
  background-color: var(--primaria);
  color: white;
  padding: 10px 20px;
  border-radius: 5px;
  text-decoration: none;
  font-weight: bold;
  transition: background-color 0.3s;
  z-index: 999; /* Garante que fique por cima de tudo */
}

        .botao-escrever:hover {
            background-color: var(--primaria-escura);
        }

        .perfil {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--primaria);
            cursor: pointer;
        }

        .perfil img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .perfil i {
            font-size: 1.2rem;
            color: white;
        }

        .conteudo-principal {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .destaque {
            background-color: var(--superficie);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            gap: 20px;
        }

        .destaque-capa {
            width: 200px;
            height: 300px;
            object-fit: cover;
            border-radius: 5px;
        }

        .destaque-info {
            flex: 1;
        }

        .destaque-titulo {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: var(--primaria);
        }

        .destaque-autor {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--texto-secundario);
        }

        .destaque-descricao {
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .destaque-generos {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .genero {
            background-color: var(--primaria);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        .botao {
            display: inline-block;
            background-color: var(--primaria);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
        }

        .botao:hover {
            background-color: var(--primaria-escura);
        }

        .filtros {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filtro {
            background-color: var(--superficie);
            border: none;
            color: var(--texto);
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
        }

        .filtro.ativo {
            background-color: var(--primaria);
        }

        .grade-livros {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .livro {
            background-color: var(--superficie);
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s;
        }

        .livro:hover {
            transform: translateY(-5px);
        }

        .livro-capa {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }

        .livro-info {
            padding: 15px;
        }

        .livro-titulo {
            font-size: 1rem;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .livro-autor {
            font-size: 0.8rem;
            color: var(--texto-secundario);
        }

        .carregando {
            text-align: center;
            padding: 50px;
            grid-column: 1 / -1;
        }

        @media (max-width: 768px) {
            .destaque {
                flex-direction: column;
            }
            
            .destaque-capa {
                width: 100%;
                height: auto;
            }
            
            .grade-livros {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .menu-superior {
                gap: 10px;
            }

            .busca input {
                width: 150px;
            }
        }
    </style>
</head>
<body>
    <header class="cabecalho">
        <a href="#" class="logo">
            <i class="fas fa-book"></i>
            BOOKISH
        </a>
        <div class="menu-superior">
            <div class="busca">
                <input type="text" id="busca" placeholder="Buscar livros...">
            </div>

            <div class="perfil" id="perfil">
                <i class="fas fa-user"></i>
            </div>
        </div>
    </header>

    <main class="conteudo-principal">
        <section id="destaque" class="destaque">
            <!-- Conteúdo será preenchido por JavaScript -->
        </section>

        <div class="filtros">
            <button class="filtro ativo" data-genero="todos">Todos</button>
            <button class="filtro" data-genero="ficcao">Ficção</button>
            <button class="filtro" data-genero="fantasia">Fantasia</button>
            <button class="filtro" data-genero="romance">Romance</button>
            <button class="filtro" data-genero="drama">Drama</button>
            <button class="filtro" data-genero="aventura">Aventura</button>
        </div>

        <div class="grade-livros" id="livros">
            <div class="carregando">
                <p>Carregando livros...</p>
            </div>
        </div>
            <a href="escrever.html" class="botao-escrever">
              <i class="fas fa-pen"></i> criar
            </a>
    </main>

    <script>
// Variáveis globais
var todosLivros = [];
var livroEmDestaque = null;
var categoriaAtiva = 'todos';
var textoBusca = '';

// Elementos da página
var destaqueEl = document.getElementById('destaque');
var livrosEl = document.getElementById('livros');
var buscaEl = document.getElementById('busca');
var filtrosEl = document.querySelectorAll('.filtro');
var perfilEl = document.getElementById('perfil');

// Carrega a foto do perfil do localStorage
function carregarFotoPerfil() {
  var foto = localStorage.getItem('imagePerfil');
  perfilEl.innerHTML = foto ?
    `<img src="${foto}" alt="Foto perfil">` :
    '<i class="fas fa-user"></i>';
}

// Busca os livros da API
function carregarLivros() {
  // Contador de requisições
  let contador = parseInt(sessionStorage.getItem("reqCount")) || 0;
  
  // Já passou do limite de 5? Usa os dados salvos
  if (contador >= 5) {
    const livrosSalvos = JSON.parse(sessionStorage.getItem("livros"));
    const destaqueSalvo = JSON.parse(sessionStorage.getItem("destaque"));
    
    if (livrosSalvos && destaqueSalvo) {
      todosLivros = livrosSalvos;
      livroEmDestaque = destaqueSalvo;
      mostrarDestaque();
      mostrarLivros();
      return;
    }
  }
  
  // Ainda pode fazer requisição
  fetch('https://exemplo-api.com/livros')
    .then(res => res.json())
    .then(function(livros) {
      todosLivros = livros;
      livroEmDestaque = livros[0];
      
      // Salva no sessionStorage
      sessionStorage.setItem("livros", JSON.stringify(livros));
      sessionStorage.setItem("destaque", JSON.stringify(livroEmDestaque));
      sessionStorage.setItem("reqCount", contador + 1);
      
      mostrarDestaque();
      mostrarLivros();
    })
    .catch(function() {
      livrosEl.innerHTML = `
        <div class="carregando">
          <p>Erro ao carregar livros. Recarregue a página.</p>
        </div>
      `;
    });
}

// Mostra o livro principal em destaque
function mostrarDestaque() {
  if (!livroEmDestaque) return;
  
  destaqueEl.innerHTML = `
    <img src="${livroEmDestaque.capa}" alt="${livroEmDestaque.titulo}">
    <div>
      <h1>${livroEmDestaque.titulo}</h1>
      <p>${livroEmDestaque.autor}</p>
      <p>${livroEmDestaque.descricao}</p>
      <div class="tags">
        ${livroEmDestaque.generos.map(function(genero) {
          return `<span class="tag">${genero}</span>`;
        }).join('')}
      </div>
      <a href="livro.html?id=${livroEmDestaque.id}" class="botao">
        Ver livro
      </a>
    </div>
  `;
}

// Mostra a lista de livros filtrados
function mostrarLivros() {
  // Filtra os livros
  var livrosFiltrados = todosLivros.filter(function(livro) {
    // Filtro por categoria
    var categoriaOk = categoriaAtiva === 'todos' ||
      livro.generos.some(function(genero) {
        return genero.toLowerCase().includes(categoriaAtiva);
      });
    
    // Filtro por busca
    var buscaOk = !textoBusca ||
      livro.titulo.toLowerCase().includes(textoBusca) ||
      livro.autor.toLowerCase().includes(textoBusca);
    
    return categoriaOk && buscaOk;
  });
  
  // Se não encontrar livros
  if (livrosFiltrados.length === 0) {
    livrosEl.innerHTML = `
      <div class="carregando">
        <p>Nenhum livro encontrado</p>
      </div>
    `;
    return;
  }
  
  // Cria o HTML dos livros
  livrosEl.innerHTML = livrosFiltrados.map(function(livro) {
    if (livro.id === livroEmDestaque.id) return '';
    
    return `
      <div class="livro" onclick="window.location='livro.html?id=${livro.id}'">
        <img src="${livro.capa}" alt="${livro.titulo}">
        <div class="livro-info">
          <h3>${livro.titulo}</h3>
          <p>${livro.autor}</p>
        </div>
      </div>
    `;
  }).join('');
}

// Configura os botões de filtro
filtrosEl.forEach(function(filtro) {
  filtro.addEventListener('click', function() {
    // Remove a classe 'ativo' de todos
    filtrosEl.forEach(function(f) {
      if (f.className.includes('ativo')) {
        f.className = f.className.replace('ativo', '').trim();
      }
    });
    
    // Adiciona ao botão clicado
    this.className += ' ativo';
    categoriaAtiva = this.getAttribute('data-categoria');
    mostrarLivros();
  });
});

// Configura a barra de busca
buscaEl.addEventListener('input', function() {
  textoBusca = this.value.trim().toLowerCase();
  mostrarLivros();
});

// Inicia tudo quando a página carrega
window.addEventListener('DOMContentLoaded', function() {
  carregarFotoPerfil();
  carregarLivros();
});
    </script>
</body>
</html>